<h1>Listing gists</h1>
<div class="error"><%= @gist_error %></div>
<%= link_to 'New Gist', new_gist_path %>

<% @gists.each do |gist| %>
  <table width="100%">
    <thead>
      <tr>
        <th></th>
        <th width="80%"></th>
        <th></th>
      </tr>
    </thead>
  
    <tbody>
        <tr>
          <td></td>  
          <td>
          <div style="display: box; box-orient: horizontal;">
            <div style="display: inline; float: left;">
              <%= gist.file_name %>
            </div>
            <div style="display: inline; float: right;">
              <%= gist.user.email %>
            </div>
          </div>
          </td>
          <td></td>
        </tr>
        
        <tr>
          <td></td>
          <td>
            <input type="hidden" value="<%= gist.text %>" id="text_editor_<%= gist.id %>"/>
            <div id="editor_<%= gist.id %>"></div>
          </td>
          <td></td>
        </tr>
        <tr>
          <td></td>
          <td>
            <div style="display: box; box-orient: horizontal;">
              <div style="display: inline; float: right;">
                <%= link_to 'Show', gist %>
              </div>
              <div style="display: inline; float: left;">
                <h3>Insert comments count here</h3>
              </div>
            </div>
          </td>
          <td></td>
        </tr>
    </tbody>
  </table>
<% end %>



<script>

  var editors = document.querySelectorAll('[id^="editor_"]');
  
  for (var i = 0; i < editors.length; i++) {
    var editor = ace.edit(editors[i].id, {
      readOnly: true,
      theme: "ace/theme/tomorrow_night_blue",
      mode: "ace/mode/html",
      autoScrollEditorIntoView: true,
      maxLines: 30,
      minLines: 5
    });
    editor.setShowPrintMargin(false);
    editor.setValue(document.getElementById("text_" + editors[i].id).value, -1);
  }

</script>